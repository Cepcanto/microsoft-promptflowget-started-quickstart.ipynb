{
  "name": "qa_with_bing",
  "nodes": [
    {
      "name": "infer_intent",
      "tool": "intent",
      "inputs": {
        "question": "${flow.question}",
        "max_tokens": "256",
        "deployment_name": "text-ada-001",
        "temperature": "0.7"
      },
      "api": "completion",
      "provider": "AzureOpenAI",
      "connection": "azure_open_ai_connection"
    },
    {
      "name": "Bing_search_1",
      "tool": "Bing.search",
      "inputs": {
        "query": "${infer_intent}",
        "count": "10"
      },
      "connection": "bing_config"
    },
    {
      "name": "combine_search_result_1",
      "tool": "combine_search_result",
      "inputs": {
        "search_result": "${Bing_search_1}"
      }
    },
    {
      "name": "qa_with_sources",
      "tool": "qa",
      "inputs": {
        "contexts": "${combine_search_result_1}",
        "question": "${flow.question}",
        "max_tokens": "256",
        "deployment_name": "text-ada-001",
        "temperature": "0.5"
      },
      "api": "completion",
      "provider": "AzureOpenAI",
      "connection": "azure_open_ai_connection"
    }
  ],
  "inputs": {
    "question": {
      "type": "string"
    }
  },
  "outputs": {
    "answer": {
      "type": "object",
      "reference": "${qa_with_sources}"
    }
  },
  "tools": [
    {
      "name": "intent",
      "description": "Infer user intent",
      "type": "llm",
      "inputs": {
        "question": {
          "name": "question",
          "type": [
            "string"
          ]
        }
      },
      "source": "intent.jinja2"
    },
    {
      "name": "Bing.search",
      "type": "python",
      "inputs": {
        "query": {
          "type": [
            "string"
          ]
        },
        "answerCount": {
          "type": [
            "int"
          ]
        },
        "cc": {
          "type": [
            "string"
          ]
        },
        "count": {
          "type": [
            "int"
          ],
          "default": "10"
        },
        "freshness": {
          "type": [
            "string"
          ]
        },
        "mkt": {
          "type": [
            "string"
          ]
        },
        "offset": {
          "type": [
            "int"
          ],
          "default": "0"
        },
        "promote": {
          "type": [
            "list"
          ],
          "default": "[]"
        },
        "responseFilter": {
          "type": [
            "list"
          ],
          "default": "[]"
        },
        "safesearch": {
          "type": [
            "string"
          ],
          "default": "Moderate"
        },
        "setLang": {
          "type": [
            "string"
          ],
          "default": "en"
        },
        "textDecorations": {
          "type": [
            "bool"
          ],
          "default": "False"
        },
        "textFormat": {
          "type": [
            "string"
          ],
          "default": "Raw"
        }
      },
      "module": "promptflow.tools.bing",
      "class_name": "Bing",
      "function": "search",
      "connection_type": [
        "Bing"
      ]
    },
    {
      "name": "combine_search_result",
      "type": "python",
      "inputs": {
        "search_result": {
          "name": "search_result",
          "type": [
            "object"
          ]
        }
      },
      "class_name": "combine_search_result",
      "function": "combine_search_result",
      "source": "combine_search_result.py"
    },
    {
      "name": "qa",
      "description": "QA with sources",
      "type": "llm",
      "inputs": {
        "question": {
          "name": "question",
          "type": [
            "string"
          ]
        },
        "contexts": {
          "name": "contexts",
          "type": [
            "string"
          ]
        }
      },
      "source": "qa.jinja2"
    }
  ]
}
