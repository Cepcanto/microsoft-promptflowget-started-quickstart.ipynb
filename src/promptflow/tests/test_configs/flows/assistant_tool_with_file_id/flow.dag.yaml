inputs:
  assistant_input:
    type: list
    default:
    - type: text
      text: Attached file contains the stock price of company A and B. Please draw a line chart with the stock price of the company A, B and C and return a CVS file with the data.
    - type: file_path
      file_path:
        path: ./stock_price.csv
  assistant_id:
    type: string
    default: asst_yWhdFYoCS1UatnRRQZGY85aL
  thread_id:
    type: string
    default: ""
outputs:
  assistant_output:
    type: string
    reference: ${add_message_and_run.output}
  thread_id:
    type: string
    reference: ${get_or_create_thread.output}
nodes:
- name: get_or_create_thread
  type: python
  source:
    type: code
    path: get_or_create_thread.py
  inputs:
    conn: openai_connection
    thread_id: ${inputs.thread_id}
- name: add_message_and_run
  type: python
  source:
    type: code
    path: add_message_and_run.py
  inputs:
    conn: openai_connection
    message: ${inputs.assistant_input}
    assistant_id: ${inputs.assistant_id}
    thread_id: ${get_or_create_thread.output}
    assistant_definition:
      model: gpt-4-1106-preview
      instructions: You are a helpful assistant.
      tools:
      - type: code_interpreter
      - type: function
        tool_type: python
        source:
          type: code
          path: get_stock_price.py
    download_images: true
version: 2
